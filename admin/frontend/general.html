<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>General - Admin</title>
  <link rel="stylesheet" href="./style/admin.css">
</head>
<body>
  <div id="root"></div>
  <script type="module">
    import { me, nav, logout } from './js/admin-common.js';
    window._logout = logout;

    const root = document.getElementById('root');
    const u = await me();
    if (!u.ok) location.href = 'login.html';

    root.innerHTML = nav('general') + `
      <main>
        <div class="card">
          <h2>¬°Hola, ${u.nombre}!</h2>
          <p style="font-size: 1.1rem; margin-bottom: 2rem;">Bienvenido al panel de administraci√≥n de Mestiza Street Food. Desde aqu√≠ pod√©s gestionar todo el carrito.</p>
          
          <h3 style="margin-top: 2rem; margin-bottom: 1rem; color: var(--primary, #f59e0b);">üìã M√≥dulos Disponibles</h3>
          
          <div style="display: grid; gap: 1.5rem;">
            <!-- Productos -->
            <div style="padding: 1.5rem; border-radius: 8px; background: var(--card-bg, #1a1a1a); border-left: 4px solid #f59e0b;">
              <h4 style="margin: 0 0 0.5rem 0; color: #f59e0b;">üçî Productos</h4>
              <p style="margin: 0 0 0.5rem 0; color: var(--text-muted, #888);">Gesti√≥n completa del men√∫ del carrito</p>
              <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
                <li>Agregar nuevos productos con nombre, categor√≠a, precio e imagen</li>
                <li>Editar productos existentes directamente desde la tabla</li>
                <li>Eliminar productos del men√∫</li>
                <li>Categor√≠as: Hamburguesas, Papas Fritas, Tacos, Toppings</li>
              </ul>
            </div>

            <!-- Pedidos -->
            <div style="padding: 1.5rem; border-radius: 8px; background: var(--card-bg, #1a1a1a); border-left: 4px solid #22c55e;">
              <h4 style="margin: 0 0 0.5rem 0; color: #22c55e;">üì¶ Pedidos</h4>
              <p style="margin: 0 0 0.5rem 0; color: var(--text-muted, #888);">Control en tiempo real de los pedidos</p>
              <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
                <li>Visualizaci√≥n de pedidos en tiempo real (refresco autom√°tico cada 5 segundos)</li>
                <li>Notificaci√≥n sonora cuando llega un nuevo pedido</li>
                <li>Cambiar estado: Pendiente ‚Üí En Preparaci√≥n ‚Üí Listo ‚Üí Entregado</li>
                <li>Ver detalle completo: productos, cantidades, direcci√≥n, m√©todo de pago</li>
                <li>Filtros por estado y fecha para b√∫squeda r√°pida</li>
              </ul>
            </div>

            <!-- Reservas -->
            <div style="padding: 1.5rem; border-radius: 8px; background: var(--card-bg, #1a1a1a); border-left: 4px solid #8b5cf6;">
              <h4 style="margin: 0 0 0.5rem 0; color: #8b5cf6;">üìÖ Reservas</h4>
              <p style="margin: 0 0 0.5rem 0; color: var(--text-muted, #888);">Administraci√≥n de reservas de mesas</p>
              <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
                <li>Ver todas las reservas con informaci√≥n completa (nombre, tel√©fono, email, fecha, hora, personas)</li>
                <li>Estad√≠sticas: total de reservas, pendientes, confirmadas, promedio de personas</li>
                <li>Cambiar estado: Pendiente ‚Üí Confirmada / Cancelada / Completada</li>
                <li>Agregar comentarios internos a cada reserva</li>
                <li>Filtros por estado y rango de fechas</li>
              </ul>
            </div>

            <!-- Calendario -->
            <div style="padding: 1.5rem; border-radius: 8px; background: var(--card-bg, #1a1a1a); border-left: 4px solid #3b82f6;">
              <h4 style="margin: 0 0 0.5rem 0; color: #3b82f6;">üóìÔ∏è Calendario</h4>
              <p style="margin: 0 0 0.5rem 0; color: var(--text-muted, #888);">Gesti√≥n de eventos y promociones</p>
              <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
                <li>Crear eventos especiales (ej: Noche de Jazz, Promociones, Catas)</li>
                <li>Vista de calendario interactivo con FullCalendar</li>
                <li>Configurar t√≠tulo, descripci√≥n, fecha de inicio/fin y color personalizado</li>
                <li>Los eventos aparecen autom√°ticamente en el calendario p√∫blico del sitio web</li>
                <li>Editar o desactivar eventos sin eliminarlos de la base de datos</li>
              </ul>
            </div>

            <!-- Estad√≠sticas -->
            <div style="padding: 1.5rem; border-radius: 8px; background: var(--card-bg, #1a1a1a); border-left: 4px solid #ef4444;">
              <h4 style="margin: 0 0 0.5rem 0; color: #ef4444;">üìä Estad√≠sticas</h4>
              <p style="margin: 0 0 0.5rem 0; color: var(--text-muted, #888);">An√°lisis completo del negocio</p>
              <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
                <li>Ventas totales con ticket promedio, m√°ximo y m√≠nimo</li>
                <li>Top 10 productos m√°s vendidos con categor√≠as</li>
                <li>Ventas por d√≠a (√∫ltimos 30 d√≠as) con gr√°fico de barras</li>
                <li>Ventas por categor√≠a de producto</li>
                <li>Ventas por hora del d√≠a para optimizar horarios</li>
                <li>Estados de pedidos (cu√°ntos est√°n en cada estado)</li>
                <li>M√©todos de pago utilizados</li>
                <li>Comparaci√≥n con per√≠odo anterior (crecimiento/decrecimiento)</li>
                <li>Filtros personalizados: Hoy, Ayer, Semana, Mes, Trimestre, A√±o</li>
              </ul>
            </div>
          </div>

          <div style="margin-top: 2rem; padding: 1rem; border-radius: 8px; background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3);">
            <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
              <span style="font-size: 1.2rem;">üí°</span>
              <strong style="color: #f59e0b;">Consejos de uso</strong>
            </div>
            <ul style="margin: 0; padding-left: 1.5rem; color: var(--text, #e0e0e0);">
              <li>El m√≥dulo de <strong>Pedidos</strong> se actualiza autom√°ticamente cada 5 segundos</li>
              <li>Usa el bot√≥n üåô/‚òÄÔ∏è en la esquina superior derecha para cambiar entre modo oscuro y claro</li>
              <li>Las reservas del p√∫blico se crean autom√°ticamente como "Pendiente"</li>
              <li>Los eventos del calendario son visibles inmediatamente en el sitio web p√∫blico</li>
              <li>Revisa las <strong>Estad√≠sticas</strong> regularmente para tomar decisiones de negocio</li>
            </ul>
          </div>
        </div>
      </main>
    `;

    // --- Theme toggle: light / dark (persistir en localStorage) ---
    (function(){
      const KEY = 'admin_theme';
      const html = document.documentElement;

      // inicializar seg√∫n preferencia guardada o prefers-color-scheme
      const saved = localStorage.getItem(KEY);
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (saved === 'light') html.setAttribute('data-theme','light');
      else if (saved === 'dark') html.removeAttribute('data-theme');
      else {
        // si no hay guardado, usar prefers-color-scheme
        if (!prefersDark) html.setAttribute('data-theme','light');
        else html.removeAttribute('data-theme');
      }

      // crear bot√≥n y a√±adir al header
      const header = document.querySelector('header');
      if (header) {
        const btn = document.createElement('button');
        btn.id = 'theme-toggle';
        btn.title = 'Cambiar modo claro/oscuro';
        btn.style.marginLeft = '8px';
        btn.style.minWidth = '40px';
        btn.style.display = 'inline-flex';
        btn.style.alignItems = 'center';
        btn.style.justifyContent = 'center';
        btn.style.gap = '6px';
        btn.className = 'btn';
        // actualizar icono seg√∫n tema actual
        const updateIcon = () => {
          const isLight = html.getAttribute('data-theme') === 'light';
          btn.textContent = isLight ? '‚òÄÔ∏è' : 'üåô';
        };
        btn.addEventListener('click', () => {
          const isLight = html.getAttribute('data-theme') === 'light';
          if (isLight) {
            html.removeAttribute('data-theme'); // vuelve a dark (default)
            localStorage.setItem(KEY, 'dark');
          } else {
            html.setAttribute('data-theme','light');
            localStorage.setItem(KEY, 'light');
          }
          updateIcon();
        });
        updateIcon();
        // insertar al final del header (ajusta si quieres dentro de nav)
        header.appendChild(btn);
      }
    })();
    // --- fin tema ---
  </script>
</body>
</html>
