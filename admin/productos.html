
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos - Panel Administrativo</title>
    <link rel="stylesheet" href="../frontend/style/style.css">

</head>
<body>
    <header>
        <div id="navMenu">
            <div class="nav-left">
                <button onclick="window.location.href='productos.html'" class="active">Productos</button>
                <button onclick="window.location.href='pedidos.html'">Pedidos</button>
                <button onclick="window.location.href='estadisticas.html'">Estadísticas</button>
                <button onclick="window.location.href='general.html'">General</button>
            </div>
            <div class="nav-right">
                <button onclick="logout()">Cerrar Sesión</button>
            </div>
        </div>
    </header>

    <main>
        <div class="hero">
            <h1>GESTIÓN DE PRODUCTOS</h1>
            <p>Añadir, editar o eliminar productos del menú</p>
        </div>

        <section class="admin-section">
            <h2 class="section-title">Productos</h2>
            <p>En la sección productos se puede añadir, editar o eliminar productos, así como ver aquellos ya existentes</p>
            
            <div class="action-buttons">
                <button class="btn-success" onclick="showAddProductModal()">Añadir Producto</button>
            </div>

            <!-- Lista de Productos -->
            <table style="width:100%; border-collapse:collapse; margin-top:20px;" id="productsTable">
                <thead>
                    <tr style="background:#c4b68c; color:white;">
                        <th style="padding:10px; text-align:left;">Imagen</th>
                        <th style="padding:10px; text-align:left;">Nombre</th>
                        <th style="padding:10px; text-align:left;">Precio</th>
                        <th style="padding:10px; text-align:left;">Categoría</th>
                        <th style="padding:10px; text-align:left;">Estado</th>
                        <th style="padding:10px; text-align:left;">Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr style="border-bottom:1px solid #ddd;" id="product-1">
                        <td style="padding:10px;"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjZGRkIi8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNTU1Ij5JTUc8L3RleHQ+Cjwvc3ZnPgo=" alt="Hamburguesa Especial" width="50"></td>
                        <td style="padding:10px;">Hamburguesa Especial</td>
                        <td style="padding:10px;">$350</td>
                        <td style="padding:10px;">Hamburguesas</td>
                        <td style="padding:10px;"><span style="background:#d4edda; color:#155724; padding:4px 8px; border-radius:10px; font-size:12px;">Visible</span></td>
                        <td style="padding:10px;">
                            <div style="display: flex; gap: 5px;">
                                <button style="background-color: #28a745; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="editProduct(1)">Editar</button>
                                <button style="background-color: #6c757d; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="toggleProduct(1)" id="toggle-1">Esconder</button>
                                <button style="background-color: #dc3545; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="deleteProduct(1)">Eliminar</button>
                            </div>
                        </td>
                    </tr>
                    <tr style="border-bottom:1px solid #ddd;" id="product-2">
                        <td style="padding:10px;"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjZGRkIi8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNTU1Ij5JTUc8L3RleHQ+Cjwvc3ZnPgo=" alt="Tacos de Pollo" width="50"></td>
                        <td style="padding:10px;">Tacos de Pollo</td>
                        <td style="padding:10px;">$280</td>
                        <td style="padding:10px;">Tacos</td>
                        <td style="padding:10px;"><span style="background:#d4edda; color:#155724; padding:4px 8px; border-radius:10px; font-size:12px;">Visible</span></td>
                        <td style="padding:10px;">
                            <div style="display: flex; gap: 5px;">
                                <button style="background-color: #28a745; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="editProduct(2)">Editar</button>
                                <button style="background-color: #6c757d; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="toggleProduct(2)" id="toggle-2">Esconder</button>
                                <button style="background-color: #dc3545; padding: 5px 10px; font-size: 12px; border: none; color: white; border-radius: 4px; cursor: pointer;" onclick="deleteProduct(2)">Eliminar</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>
    </main>

    <!-- Modal para Añadir/Editar Producto -->
    <div id="productModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div style="background-color: #fefefe; margin: 5% auto; padding: 20px; border-radius: 12px; width: 80%; max-width: 500px;">
            <span style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;" onclick="closeProductModal()">&times;</span>
            <h2 id="modalTitle">Añadir Producto</h2>
            <form id="productForm">
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Nombre del producto:</label>
                    <input type="text" id="productName" required style="width: 100%; padding: 10px; border: 2px solid #c4b68c; border-radius: 8px; font-size: 14px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Precio:</label>
                    <input type="number" id="productPrice" required style="width: 100%; padding: 10px; border: 2px solid #c4b68c; border-radius: 8px; font-size: 14px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Categoría:</label>
                    <select id="productCategory" required style="width: 100%; padding: 10px; border: 2px solid #c4b68c; border-radius: 8px; font-size: 14px;">
                        <option value="">Seleccionar categoría</option>
                        <option value="Hamburguesas">Hamburguesas</option>
                        <option value="Tacos">Tacos</option>
                        <option value="Pizzas">Pizzas</option>
                        <option value="Bebidas">Bebidas</option>
                        <option value="Postres">Postres</option>
                    </select>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: bold; color: #333;">Imagen:</label>
                    <input type="file" id="productImage" accept="image/*" style="width: 100%; padding: 10px; border: 2px solid #c4b68c; border-radius: 8px; font-size: 14px;">
                    <small>Nota: La imagen debe estar guardada en el sistema previamente</small>
                </div>
                <div class="action-buttons">
                    <button type="submit" style="background-color: #28a745;">Aceptar</button>
                    <button type="button" onclick="closeProductModal()">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmación -->
    <div id="confirmModal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div style="background-color: #fefefe; margin: 5% auto; padding: 20px; border-radius: 12px; width: 80%; max-width: 500px;">
            <h3>Confirmar Acción</h3>
            <p id="confirmMessage"></p>
            <div class="action-buttons">
                <button style="background-color: #dc3545;" id="confirmBtn">Aceptar</button>
                <button onclick="closeConfirmModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Sistema Administrativo del Restaurante. Todos los derechos reservados.</p>
    </footer>

    <script>
        let currentEditingProduct = null;

        function showAddProductModal() {
            document.getElementById('modalTitle').textContent = 'Añadir Producto';
            document.getElementById('productForm').reset();
            currentEditingProduct = null;
            document.getElementById('productModal').style.display = 'block';
        }

        function editProduct(id) {
            document.getElementById('modalTitle').textContent = 'Editar Producto';
            currentEditingProduct = id;
            
            // Llenar el formulario con los datos existentes
            const row = document.getElementById(`product-${id}`);
            const cells = row.cells;
            
            document.getElementById('productName').value = cells[1].textContent;
            document.getElementById('productPrice').value = cells[2].textContent.replace('$', '');
            document.getElementById('productCategory').value = cells[3].textContent;
            
            document.getElementById('productModal').style.display = 'block';
        }

        function toggleProduct(id) {
            const row = document.getElementById(`product-${id}`);
            const toggleBtn = document.getElementById(`toggle-${id}`);
            const statusCell = row.cells[4];
            
            if (row.classList.contains('product-hidden')) {
                // Mostrar producto
                row.classList.remove('product-hidden');
                toggleBtn.textContent = 'Esconder';
                toggleBtn.className = 'btn-hide';
                statusCell.innerHTML = '<span style="background:#d4edda; color:#155724; padding:4px 8px; border-radius:10px; font-size:12px;">Visible</span>';
            } else {
                // Esconder producto
                row.classList.add('product-hidden');
                toggleBtn.textContent = 'Mostrar';
                toggleBtn.className = 'btn-show';
                statusCell.innerHTML = '<span style="background:#f8d7da; color:#721c24; padding:4px 8px; border-radius:10px; font-size:12px;">Oculto</span>';
            }
        }

        function deleteProduct(id) {
            document.getElementById('confirmMessage').textContent = 'Esta acción es permanente y no se puede deshacer. ¿Está seguro de que desea eliminar este producto?';
            document.getElementById('confirmBtn').onclick = function() {
                document.getElementById(`product-${id}`).remove();
                closeConfirmModal();
                alert('Producto eliminado permanentemente');
            };
            document.getElementById('confirmModal').style.display = 'block';
        }

        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        // Manejar formulario de producto
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('productName').value;
            const price = document.getElementById('productPrice').value;
            const category = document.getElementById('productCategory').value;
            
            if (currentEditingProduct) {
                // Editar producto existente
                const row = document.getElementById(`product-${currentEditingProduct}`);
                const cells = row.cells;
                cells[1].textContent = name;
                cells[2].textContent = '$' + price;
                cells[3].textContent = category;
                alert('Producto actualizado correctamente');
            } else {
                // Añadir nuevo producto
                const newId = Date.now(); // ID simple basado en timestamp
                const tbody = document.querySelector('#productsTable tbody');
                const newRow = `
                    <tr style="border-bottom:1px solid #ddd;" id="product-${newId}">
                        <td style="padding:10px;"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIHZpZXdCb3g9IjAgMCA1MCA1MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiBmaWxsPSIjZGRkIi8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNTU1Ij5JTUc8L3RleHQ+Cjwvc3ZnPgo=" alt="${name}" width="50"></td>
                        <td style="padding:10px;">${name}</td>
                        <td style="padding:10px;">$${price}</td>
                        <td style="padding:10px;">${category}</td>
                        <td style="padding:10px;"><span style="background:#d4edda; color:#155724; padding:4px 8px; border-radius:10px; font-size:12px;">Visible</span></td>
                        <td style="padding:10px;">
                            <div class="product-actions">
                                <button class="btn-edit" onclick="editProduct(${newId})">Editar</button>
                                <button class="btn-hide" onclick="toggleProduct(${newId})" id="toggle-${newId}">Esconder</button>
                                <button class="btn-delete" onclick="deleteProduct(${newId})">Eliminar</button>
                            </div>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += newRow;
                alert('Producto añadido correctamente');
            }
            
            closeProductModal();
        });

        function logout() {
            if(confirm('¿Estás seguro de que deseas cerrar sesión?')) {
                window.location.href = 'login.html';
            }
        }

        // Cerrar modal al hacer clic fuera de él
        window.onclick = function(event) {
            const productModal = document.getElementById('productModal');
            const confirmModal = document.getElementById('confirmModal');
            if (event.target === productModal) {
                closeProductModal();
            }
            if (event.target === confirmModal) {
                closeConfirmModal();
            }
        }
    </script>
</body>
</html>